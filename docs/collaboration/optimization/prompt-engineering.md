# Prompt Engineering 優化

Prompt 優化是提升 LLM 表現最直接且成本最低的方法。

## 優化原則

| 原則 | 說明 |
|------|------|
| 清晰明確 | 避免歧義，明確目標 |
| 結構化 | 使用標記區分內容 |
| 給予示例 | Few-shot 提升效果 |
| 設定角色 | 明確 AI 的身份 |

---

## 優化技巧

### 1. 使用分隔符

```text
你是客服助手。

### 用戶問題 ###
{user_input}

### 回答要求 ###
1. 簡潔回答
2. 使用繁體中文
```

### 2. Few-shot 示例

```text
範例對話：
用戶：查訂單
助手：請提供您的訂單號，我來幫您查詢。

用戶：{actual_input}
助手：
```

### 3. 思維鏈（CoT）

```text
請逐步分析：
1. 理解用戶意圖
2. 確認所需資訊
3. 提供解決方案

用戶問題：{input}
```

---

## 常見問題優化

| 問題 | 優化方式 |
|------|----------|
| 回答太長 | 加入「簡潔回答」指令 |
| 格式不一致 | 提供格式範例 |
| 幻覺問題 | 強調「僅基於提供資訊」 |
| 拒絕過多 | 調整安全指令強度 |

---

## A/B 測試

```yaml
ab_test:
  control: "原始 Prompt"
  variant: "優化 Prompt"
  
  metrics:
    - answer_relevancy
    - format_accuracy
    - user_satisfaction
    
  sample_size: 1000
  duration: "7 days"
```

---

## 迭代流程

```mermaid
graph LR
    A["識別問題"] --> B["假設原因"]
    B --> C["修改 Prompt"]
    C --> D["測試驗證"]
    D --> |效果不佳| A
    D --> |效果良好| E["上線部署"]
```

---

## 最佳實踐

!!! success "優化要點"
    1. 逐步迭代，單次改動單一變量
    2. 保留歷史版本便於對比
    3. 使用評測指標量化效果
    4. 收集 Bad Case 針對性優化
